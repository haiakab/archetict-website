{"version":3,"file":"controls.js","sourceRoot":"","sources":["../../src/features/controls.ts"],"names":[],"mappings":"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","sourcesContent":["/* @license\n * Copyright 2019 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the 'License');\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an 'AS IS' BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {property} from 'lit-element';\nimport {Event, PerspectiveCamera, Spherical, Vector3} from 'three';\nimport {style} from '../decorators.js';\nimport ModelViewerElementBase, {$ariaLabel, $container, $hasTransitioned, $loadedTime, $needsRender, $onModelLoad, $onResize, $renderer, $scene, $tick, $userInputElement, toVector3D, Vector3D} from '../model-viewer-base.js';\nimport {degreesToRadians, normalizeUnit} from '../styles/conversions.js';\nimport {EvaluatedStyle, Intrinsics, SphericalIntrinsics, StyleEvaluator, Vector3Intrinsics} from '../styles/evaluators.js';\nimport {IdentNode, NumberNode, numberNode, parseExpressions} from '../styles/parsers.js';\nimport {DECAY_MILLISECONDS} from '../three-components/Damper.js';\nimport {SAFE_RADIUS_RATIO} from '../three-components/ModelScene.js';\nimport {ChangeEvent, ChangeSource, PointerChangeEvent, SmoothControls} from '../three-components/SmoothControls.js';\nimport {Constructor} from '../utilities.js';\nimport {timeline} from '../utilities/animation.js';\n\n\n// NOTE(cdata): The following \"animation\" timing functions are deliberately\n// being used in favor of CSS animations. In Safari 12.1 and 13, CSS animations\n// would cause the interaction prompt to glitch unexpectedly\n// @see https://github.com/google/model-viewer/issues/839\nconst PROMPT_ANIMATION_TIME = 5000;\n\n// For timing purposes, a \"frame\" is a timing agnostic relative unit of time\n// and a \"value\" is a target value for the keyframe.\nconst wiggle = timeline(0, [\n  {frames: 5, value: -1},\n  {frames: 1, value: -1},\n  {frames: 8, value: 1},\n  {frames: 1, value: 1},\n  {frames: 5, value: 0},\n  {frames: 18, value: 0}\n]);\n\nconst fade = timeline(0, [\n  {frames: 1, value: 1},\n  {frames: 5, value: 1},\n  {frames: 1, value: 0},\n  {frames: 6, value: 0}\n]);\n\nexport const DEFAULT_CAMERA_ORBIT = '0deg 75deg 105%';\nconst DEFAULT_CAMERA_TARGET = 'auto auto auto';\nconst DEFAULT_FIELD_OF_VIEW = 'auto';\n\nconst MINIMUM_RADIUS_RATIO = 1.1 * SAFE_RADIUS_RATIO;\n\nconst AZIMUTHAL_QUADRANT_LABELS = ['front', 'right', 'back', 'left'];\nconst POLAR_TRIENT_LABELS = ['upper-', '', 'lower-'];\n\nexport const DEFAULT_INTERACTION_PROMPT_THRESHOLD = 3000;\nexport const INTERACTION_PROMPT =\n    'Use mouse, touch or arrow keys to control the camera!';\n\nexport interface CameraChangeDetails {\n  source: ChangeSource;\n}\n\nexport interface SphericalPosition {\n  theta: number;  // equator angle around the y (up) axis.\n  phi: number;    // polar angle from the y (up) axis.\n  radius: number;\n  toString(): string;\n}\n\nexport type InteractionPromptStrategy = 'auto'|'when-focused'|'none';\nexport type InteractionPromptStyle = 'basic'|'wiggle';\nexport type InteractionPolicy = 'always-allow'|'allow-when-focused';\nexport type TouchAction = 'pan-y'|'pan-x'|'none';\nexport type Bounds = 'tight'|'legacy';\n\nexport const InteractionPromptStrategy:\n    {[index: string]: InteractionPromptStrategy} = {\n      AUTO: 'auto',\n      WHEN_FOCUSED: 'when-focused',\n      NONE: 'none'\n    };\n\nexport const InteractionPromptStyle:\n    {[index: string]: InteractionPromptStyle} = {\n      BASIC: 'basic',\n      WIGGLE: 'wiggle'\n    };\n\nexport const InteractionPolicy: {[index: string]: InteractionPolicy} = {\n  ALWAYS_ALLOW: 'always-allow',\n  WHEN_FOCUSED: 'allow-when-focused'\n};\n\nexport const TouchAction: {[index: string]: TouchAction} = {\n  PAN_Y: 'pan-y',\n  PAN_X: 'pan-x',\n  NONE: 'none'\n};\n\nexport const fieldOfViewIntrinsics = (element: ModelViewerElementBase) => {\n  return {\n    basis: [numberNode(\n        (element as any)[$zoomAdjustedFieldOfView] * Math.PI / 180, 'rad')],\n    keywords: {auto: [null]}\n  };\n};\n\nconst minFieldOfViewIntrinsics = {\n  basis: [degreesToRadians(numberNode(25, 'deg')) as NumberNode<'rad'>],\n  keywords: {auto: [null]}\n};\n\nconst maxFieldOfViewIntrinsics = (element: ModelViewerElementBase) => {\n  const scene = element[$scene];\n\n  return {\n    basis: [degreesToRadians(numberNode(45, 'deg')) as NumberNode<'rad'>],\n    keywords: {auto: [numberNode(scene.framedFieldOfView, 'deg')]}\n  };\n};\n\nexport const cameraOrbitIntrinsics = (() => {\n  const defaultTerms =\n      parseExpressions(DEFAULT_CAMERA_ORBIT)[0]\n          .terms as [NumberNode<'rad'>, NumberNode<'rad'>, IdentNode];\n\n  const theta = normalizeUnit(defaultTerms[0]) as NumberNode<'rad'>;\n  const phi = normalizeUnit(defaultTerms[1]) as NumberNode<'rad'>;\n\n  return (element: ModelViewerElementBase) => {\n    const radius = element[$scene].idealCameraDistance;\n\n    return {\n      basis: [theta, phi, numberNode(radius, 'm')],\n      keywords: {auto: [null, null, numberNode(105, '%')]}\n    };\n  };\n})();\n\nconst minCameraOrbitIntrinsics = (element: ModelViewerElementBase) => {\n  const radius = MINIMUM_RADIUS_RATIO * element[$scene].idealCameraDistance;\n\n  return {\n    basis: [\n      numberNode(-Infinity, 'rad'),\n      numberNode(Math.PI / 8, 'rad'),\n      numberNode(radius, 'm')\n    ],\n    keywords: {auto: [null, null, null]}\n  };\n};\n\nconst maxCameraOrbitIntrinsics = (element: ModelViewerElementBase) => {\n  const orbitIntrinsics = cameraOrbitIntrinsics(element);\n  const evaluator = new StyleEvaluator([], orbitIntrinsics);\n  const defaultRadius = evaluator.evaluate()[2];\n\n  return {\n    basis: [\n      numberNode(Infinity, 'rad'),\n      numberNode(Math.PI - Math.PI / 8, 'rad'),\n      numberNode(defaultRadius, 'm')\n    ],\n    keywords: {auto: [null, null, null]}\n  };\n};\n\nexport const cameraTargetIntrinsics = (element: ModelViewerElementBase) => {\n  const center = element[$scene].boundingBox.getCenter(new Vector3());\n\n  return {\n    basis: [\n      numberNode(center.x, 'm'),\n      numberNode(center.y, 'm'),\n      numberNode(center.z, 'm')\n    ],\n    keywords: {auto: [null, null, null]}\n  };\n};\n\nconst HALF_PI = Math.PI / 2.0;\nconst THIRD_PI = Math.PI / 3.0;\nconst QUARTER_PI = HALF_PI / 2.0;\nconst TAU = 2.0 * Math.PI;\n\nexport const $controls = Symbol('controls');\nexport const $promptElement = Symbol('promptElement');\nexport const $promptAnimatedContainer = Symbol('promptAnimatedContainer');\nexport const $idealCameraDistance = Symbol('idealCameraDistance');\n\nconst $deferInteractionPrompt = Symbol('deferInteractionPrompt');\nconst $updateAria = Symbol('updateAria');\nconst $updateCameraForRadius = Symbol('updateCameraForRadius');\n\nconst $onBlur = Symbol('onBlur');\nconst $onFocus = Symbol('onFocus');\nconst $onChange = Symbol('onChange');\nconst $onPointerChange = Symbol('onPointerChange');\n\nconst $waitingToPromptUser = Symbol('waitingToPromptUser');\nconst $userHasInteracted = Symbol('userHasInteracted');\nconst $promptElementVisibleTime = Symbol('promptElementVisibleTime');\nconst $lastPromptOffset = Symbol('lastPromptOffset');\nconst $focusedTime = Symbol('focusedTime');\n\nconst $zoomAdjustedFieldOfView = Symbol('zoomAdjustedFieldOfView');\nconst $lastSpherical = Symbol('lastSpherical');\nconst $jumpCamera = Symbol('jumpCamera');\nconst $initialized = Symbol('initialized');\nconst $maintainThetaPhi = Symbol('maintainThetaPhi');\n\nconst $syncCameraOrbit = Symbol('syncCameraOrbit');\nconst $syncFieldOfView = Symbol('syncFieldOfView');\nconst $syncCameraTarget = Symbol('syncCameraTarget');\n\nconst $syncMinCameraOrbit = Symbol('syncMinCameraOrbit');\nconst $syncMaxCameraOrbit = Symbol('syncMaxCameraOrbit');\nconst $syncMinFieldOfView = Symbol('syncMinFieldOfView');\nconst $syncMaxFieldOfView = Symbol('syncMaxFieldOfView');\n\nexport declare interface ControlsInterface {\n  cameraControls: boolean;\n  cameraOrbit: string;\n  cameraTarget: string;\n  fieldOfView: string;\n  minCameraOrbit: string;\n  maxCameraOrbit: string;\n  minFieldOfView: string;\n  maxFieldOfView: string;\n  interactionPrompt: InteractionPromptStrategy;\n  interactionPromptStyle: InteractionPromptStyle;\n  interactionPolicy: InteractionPolicy;\n  interactionPromptThreshold: number;\n  orbitSensitivity: number;\n  touchAction: TouchAction;\n  bounds: Bounds;\n  interpolationDecay: number;\n  getCameraOrbit(): SphericalPosition;\n  getCameraTarget(): Vector3D;\n  getFieldOfView(): number;\n  getMinimumFieldOfView(): number;\n  getMaximumFieldOfView(): number;\n  jumpCameraToGoal(): void;\n  updateFraming(): Promise<void>;\n  resetInteractionPrompt(): void;\n}\n\nexport const ControlsMixin = <T extends Constructor<ModelViewerElementBase>>(\n    ModelViewerElement: T): Constructor<ControlsInterface>&T => {\n  class ControlsModelViewerElement extends ModelViewerElement {\n    @property({type: Boolean, attribute: 'camera-controls'})\n    cameraControls: boolean = false;\n\n    @style({\n      intrinsics: cameraOrbitIntrinsics,\n      observeEffects: true,\n      updateHandler: $syncCameraOrbit\n    })\n    @property({type: String, attribute: 'camera-orbit', hasChanged: () => true})\n    cameraOrbit: string = DEFAULT_CAMERA_ORBIT;\n\n    @style({\n      intrinsics: cameraTargetIntrinsics,\n      observeEffects: true,\n      updateHandler: $syncCameraTarget\n    })\n    @property(\n        {type: String, attribute: 'camera-target', hasChanged: () => true})\n    cameraTarget: string = DEFAULT_CAMERA_TARGET;\n\n    @style({\n      intrinsics: fieldOfViewIntrinsics,\n      observeEffects: true,\n      updateHandler: $syncFieldOfView\n    })\n    @property(\n        {type: String, attribute: 'field-of-view', hasChanged: () => true})\n    fieldOfView: string = DEFAULT_FIELD_OF_VIEW;\n\n    @style({\n      intrinsics: minCameraOrbitIntrinsics,\n      updateHandler: $syncMinCameraOrbit\n    })\n    @property(\n        {type: String, attribute: 'min-camera-orbit', hasChanged: () => true})\n    minCameraOrbit: string = 'auto';\n\n    @style({\n      intrinsics: maxCameraOrbitIntrinsics,\n      updateHandler: $syncMaxCameraOrbit\n    })\n    @property(\n        {type: String, attribute: 'max-camera-orbit', hasChanged: () => true})\n    maxCameraOrbit: string = 'auto';\n\n    @style({\n      intrinsics: minFieldOfViewIntrinsics,\n      updateHandler: $syncMinFieldOfView\n    })\n    @property(\n        {type: String, attribute: 'min-field-of-view', hasChanged: () => true})\n    minFieldOfView: string = 'auto';\n\n    @style({\n      intrinsics: maxFieldOfViewIntrinsics,\n      updateHandler: $syncMaxFieldOfView\n    })\n    @property(\n        {type: String, attribute: 'max-field-of-view', hasChanged: () => true})\n    maxFieldOfView: string = 'auto';\n\n    @property({type: Number, attribute: 'interaction-prompt-threshold'})\n    interactionPromptThreshold: number = DEFAULT_INTERACTION_PROMPT_THRESHOLD;\n\n    @property({type: String, attribute: 'interaction-prompt-style'})\n    interactionPromptStyle: InteractionPromptStyle =\n        InteractionPromptStyle.WIGGLE;\n\n    @property({type: String, attribute: 'interaction-prompt'})\n    interactionPrompt: InteractionPromptStrategy =\n        InteractionPromptStrategy.AUTO;\n\n    @property({type: String, attribute: 'interaction-policy'})\n    interactionPolicy: InteractionPolicy = InteractionPolicy.ALWAYS_ALLOW;\n\n    @property({type: Number, attribute: 'orbit-sensitivity'})\n    orbitSensitivity: number = 1;\n\n    @property({type: String, attribute: 'touch-action'})\n    touchAction: TouchAction = TouchAction.PAN_Y;\n\n    @property({type: Boolean, attribute: 'disable-zoom'})\n    disableZoom: boolean = false;\n\n    @property({type: Number, attribute: 'interpolation-decay'})\n    interpolationDecay: number = DECAY_MILLISECONDS;\n\n    @property({type: String, attribute: 'bounds'}) bounds: Bounds = 'legacy';\n\n    protected[$promptElement] =\n        this.shadowRoot!.querySelector('.interaction-prompt') as HTMLElement;\n    protected[$promptAnimatedContainer] =\n        this.shadowRoot!.querySelector(\n            '.interaction-prompt > .animated-container') as HTMLElement;\n\n    protected[$focusedTime] = Infinity;\n    protected[$lastPromptOffset] = 0;\n    protected[$promptElementVisibleTime] = Infinity;\n    protected[$userHasInteracted] = false;\n    protected[$waitingToPromptUser] = false;\n\n    protected[$controls] = new SmoothControls(\n        this[$scene].camera as PerspectiveCamera, this[$userInputElement]);\n\n    protected[$zoomAdjustedFieldOfView] = 0;\n    protected[$lastSpherical] = new Spherical();\n    protected[$jumpCamera] = false;\n    protected[$initialized] = false;\n    protected[$maintainThetaPhi] = false;\n\n    getCameraOrbit(): SphericalPosition {\n      const {theta, phi, radius} = this[$lastSpherical];\n      return {\n        theta,\n        phi,\n        radius,\n        toString() {\n          return `${this.theta}rad ${this.phi}rad ${this.radius}m`;\n        }\n      };\n    }\n\n    getCameraTarget(): Vector3D {\n      return toVector3D(\n          this[$renderer].isPresenting ? this[$renderer].arRenderer.target :\n                                         this[$scene].getTarget());\n    }\n\n    getFieldOfView(): number {\n      return this[$controls].getFieldOfView();\n    }\n\n    // Provided so user code does not have to parse these from attributes.\n    getMinimumFieldOfView(): number {\n      return this[$controls].options.minimumFieldOfView!;\n    }\n\n    getMaximumFieldOfView(): number {\n      return this[$controls].options.maximumFieldOfView!;\n    }\n\n    jumpCameraToGoal() {\n      this[$jumpCamera] = true;\n      this.requestUpdate($jumpCamera, false);\n    }\n\n    resetInteractionPrompt() {\n      this[$lastPromptOffset] = 0;\n      this[$promptElementVisibleTime] = Infinity;\n      this[$userHasInteracted] = false;\n      this[$waitingToPromptUser] =\n          this.interactionPrompt === InteractionPromptStrategy.AUTO &&\n          this.cameraControls;\n    }\n\n    connectedCallback() {\n      super.connectedCallback();\n\n      this[$controls].addEventListener(\n          'change', this[$onChange] as (event: Event) => void);\n      this[$controls].addEventListener(\n          'pointer-change-start',\n          this[$onPointerChange] as (event: Event) => void);\n      this[$controls].addEventListener(\n          'pointer-change-end',\n          this[$onPointerChange] as (event: Event) => void);\n    }\n\n    disconnectedCallback() {\n      super.disconnectedCallback();\n\n      this[$controls].removeEventListener(\n          'change', this[$onChange] as (event: Event) => void);\n      this[$controls].removeEventListener(\n          'pointer-change-start',\n          this[$onPointerChange] as (event: Event) => void);\n      this[$controls].removeEventListener(\n          'pointer-change-end',\n          this[$onPointerChange] as (event: Event) => void);\n    }\n\n    updated(changedProperties: Map<string|number|symbol, unknown>) {\n      super.updated(changedProperties);\n\n      const controls = this[$controls];\n      const input = this[$userInputElement];\n\n      if (changedProperties.has('cameraControls')) {\n        if (this.cameraControls) {\n          controls.enableInteraction();\n          if (this.interactionPrompt === InteractionPromptStrategy.AUTO) {\n            this[$waitingToPromptUser] = true;\n          }\n\n          input.addEventListener('focus', this[$onFocus]);\n          input.addEventListener('blur', this[$onBlur]);\n        } else {\n          input.removeEventListener('focus', this[$onFocus]);\n          input.removeEventListener('blur', this[$onBlur]);\n\n          controls.disableInteraction();\n          this[$deferInteractionPrompt]();\n        }\n      }\n\n      if (changedProperties.has('disableZoom')) {\n        controls.disableZoom = this.disableZoom;\n      }\n\n      if (changedProperties.has('bounds')) {\n        this[$scene].tightBounds = this.bounds === 'tight';\n      }\n\n      if (changedProperties.has('interactionPrompt') ||\n          changedProperties.has('cameraControls') ||\n          changedProperties.has('src')) {\n        if (this.interactionPrompt === InteractionPromptStrategy.AUTO &&\n            this.cameraControls && !this[$userHasInteracted]) {\n          this[$waitingToPromptUser] = true;\n        } else {\n          this[$deferInteractionPrompt]();\n        }\n      }\n\n      if (changedProperties.has('interactionPromptStyle')) {\n        this[$promptElement].classList.toggle(\n            'wiggle',\n            this.interactionPromptStyle === InteractionPromptStyle.WIGGLE);\n      }\n\n      if (changedProperties.has('interactionPolicy')) {\n        const interactionPolicy = this.interactionPolicy;\n        controls.applyOptions({interactionPolicy});\n      }\n\n      if (changedProperties.has('touchAction')) {\n        const touchAction = this.touchAction;\n        controls.applyOptions({touchAction});\n      }\n\n      if (changedProperties.has('orbitSensitivity')) {\n        controls.sensitivity = this.orbitSensitivity;\n      }\n\n      if (changedProperties.has('interpolationDecay')) {\n        controls.setDamperDecayTime(this.interpolationDecay);\n        this[$scene].setTargetDamperDecayTime(this.interpolationDecay);\n      }\n\n      if (this[$jumpCamera] === true) {\n        Promise.resolve().then(() => {\n          controls.jumpToGoal();\n          this[$scene].jumpToGoal();\n          this[$jumpCamera] = false;\n        });\n      }\n    }\n\n    async updateFraming() {\n      const scene = this[$scene];\n      const oldFramedFieldOfView = scene.framedFieldOfView;\n\n      await this.requestUpdate('cameraTarget');\n\n      scene.updateFraming(\n          this.bounds === 'tight' ? scene.getTarget() : undefined);\n      scene.frameModel();\n\n      const newFramedFieldOfView = scene.framedFieldOfView;\n      const zoom = this[$controls].getFieldOfView() / oldFramedFieldOfView;\n      this[$zoomAdjustedFieldOfView] = newFramedFieldOfView * zoom;\n      this[$maintainThetaPhi] = true;\n\n      this.requestUpdate('maxFieldOfView');\n      this.requestUpdate('fieldOfView');\n      this.requestUpdate('minCameraOrbit');\n      this.requestUpdate('maxCameraOrbit');\n      await this.requestUpdate('cameraOrbit');\n    }\n\n    [$syncFieldOfView](style: EvaluatedStyle<Intrinsics<['rad']>>) {\n      this[$controls].setFieldOfView(style[0] * 180 / Math.PI);\n    }\n\n    [$syncCameraOrbit](style: EvaluatedStyle<SphericalIntrinsics>) {\n      if (this[$maintainThetaPhi]) {\n        const {theta, phi} = this.getCameraOrbit();\n        style[0] = theta;\n        style[1] = phi;\n        this[$maintainThetaPhi] = false;\n      }\n      this[$controls].setOrbit(style[0], style[1], style[2]);\n    }\n\n    [$syncMinCameraOrbit](style: EvaluatedStyle<SphericalIntrinsics>) {\n      this[$controls].applyOptions({\n        minimumAzimuthalAngle: style[0],\n        minimumPolarAngle: style[1],\n        minimumRadius: style[2]\n      });\n      this.jumpCameraToGoal();\n    }\n\n    [$syncMaxCameraOrbit](style: EvaluatedStyle<SphericalIntrinsics>) {\n      this[$controls].applyOptions({\n        maximumAzimuthalAngle: style[0],\n        maximumPolarAngle: style[1],\n        maximumRadius: style[2]\n      });\n      this[$updateCameraForRadius](style[2]);\n      this.jumpCameraToGoal();\n    }\n\n    [$syncMinFieldOfView](style: EvaluatedStyle<Intrinsics<['rad']>>) {\n      this[$controls].applyOptions(\n          {minimumFieldOfView: style[0] * 180 / Math.PI});\n      this.jumpCameraToGoal();\n    }\n\n    [$syncMaxFieldOfView](style: EvaluatedStyle<Intrinsics<['rad']>>) {\n      this[$controls].applyOptions(\n          {maximumFieldOfView: style[0] * 180 / Math.PI});\n      this.jumpCameraToGoal();\n    }\n\n    [$syncCameraTarget](style: EvaluatedStyle<Vector3Intrinsics>) {\n      const [x, y, z] = style;\n      this[$scene].setTarget(x, y, z);\n      this[$renderer].arRenderer.updateTarget();\n    }\n\n    [$tick](time: number, delta: number) {\n      super[$tick](time, delta);\n\n      if (this[$renderer].isPresenting || !this[$hasTransitioned]()) {\n        return;\n      }\n\n      const now = performance.now();\n      if (this[$waitingToPromptUser]) {\n        const thresholdTime =\n            this.interactionPrompt === InteractionPromptStrategy.AUTO ?\n            this[$loadedTime] :\n            this[$focusedTime];\n\n        if (this.loaded &&\n            now > thresholdTime + this.interactionPromptThreshold) {\n          this[$userInputElement].setAttribute(\n              'aria-label', INTERACTION_PROMPT);\n\n          this[$waitingToPromptUser] = false;\n          this[$promptElementVisibleTime] = now;\n\n          this[$promptElement].classList.add('visible');\n        }\n      }\n\n      if (isFinite(this[$promptElementVisibleTime]) &&\n          this.interactionPromptStyle === InteractionPromptStyle.WIGGLE) {\n        const scene = this[$scene];\n        const animationTime =\n            ((now - this[$promptElementVisibleTime]) / PROMPT_ANIMATION_TIME) %\n            1;\n        const offset = wiggle(animationTime);\n        const opacity = fade(animationTime);\n\n        this[$promptAnimatedContainer].style.opacity = `${opacity}`;\n\n        if (offset !== this[$lastPromptOffset]) {\n          const xOffset = offset * scene.width * 0.05;\n          const deltaTheta = (offset - this[$lastPromptOffset]) * Math.PI / 16;\n\n          this[$promptAnimatedContainer].style.transform =\n              `translateX(${xOffset}px)`;\n\n          this[$controls].adjustOrbit(deltaTheta, 0, 0);\n\n          this[$lastPromptOffset] = offset;\n        }\n      }\n\n      this[$controls].update(time, delta);\n      this[$scene].updateTarget(delta);\n    }\n\n    [$deferInteractionPrompt]() {\n      // Effectively cancel the timer waiting for user interaction:\n      this[$waitingToPromptUser] = false;\n      this[$promptElement].classList.remove('visible');\n      this[$promptElementVisibleTime] = Infinity;\n    }\n\n    /**\n     * Updates the camera's near and far planes to enclose the scene when\n     * orbiting at the supplied radius.\n     */\n    [$updateCameraForRadius](radius: number) {\n      const {idealCameraDistance} = this[$scene];\n      const maximumRadius = Math.max(idealCameraDistance, radius);\n\n      const near = 0;\n      const far = 2 * maximumRadius;\n      this[$controls].updateNearFar(near, far);\n    }\n\n    [$updateAria]() {\n      // NOTE(cdata): It is possible that we might want to record the\n      // last spherical when the label actually changed. Right now, the\n      // side-effect the current implementation is that we will only\n      // announce the first view change that occurs after the element\n      // becomes focused.\n      const {theta: lastTheta, phi: lastPhi} = this[$lastSpherical];\n      const {theta, phi} =\n          this[$controls]!.getCameraSpherical(this[$lastSpherical]);\n\n      const rootNode = this.getRootNode() as Document | ShadowRoot | null;\n\n      // Only change the aria-label if <model-viewer> is currently focused:\n      if (rootNode != null && rootNode.activeElement === this) {\n        const lastAzimuthalQuadrant =\n            (4 + Math.floor(((lastTheta % TAU) + QUARTER_PI) / HALF_PI)) % 4;\n        const azimuthalQuadrant =\n            (4 + Math.floor(((theta % TAU) + QUARTER_PI) / HALF_PI)) % 4;\n\n        const lastPolarTrient = Math.floor(lastPhi / THIRD_PI);\n        const polarTrient = Math.floor(phi / THIRD_PI);\n\n        if (azimuthalQuadrant !== lastAzimuthalQuadrant ||\n            polarTrient !== lastPolarTrient) {\n          const azimuthalQuadrantLabel =\n              AZIMUTHAL_QUADRANT_LABELS[azimuthalQuadrant];\n          const polarTrientLabel = POLAR_TRIENT_LABELS[polarTrient];\n\n          const ariaLabel =\n              `View from stage ${polarTrientLabel}${azimuthalQuadrantLabel}`;\n\n          this[$userInputElement].setAttribute('aria-label', ariaLabel);\n        }\n      }\n    }\n\n    [$onResize](event: any) {\n      const controls = this[$controls];\n      const oldFramedFieldOfView = this[$scene].framedFieldOfView;\n\n      // The super of $onResize will update the scene's framedFieldOfView, so we\n      // compare the before and after to calculate the proper zoom.\n      super[$onResize](event);\n\n      const newFramedFieldOfView = this[$scene].framedFieldOfView;\n      const zoom = controls.getFieldOfView() / oldFramedFieldOfView;\n      this[$zoomAdjustedFieldOfView] = newFramedFieldOfView * zoom;\n\n      controls.updateAspect(this[$scene].aspect);\n\n      this.requestUpdate('maxFieldOfView', this.maxFieldOfView);\n      this.requestUpdate('fieldOfView', this.fieldOfView);\n      this.jumpCameraToGoal();\n    }\n\n    [$onModelLoad]() {\n      super[$onModelLoad]();\n\n      const {framedFieldOfView} = this[$scene];\n      this[$zoomAdjustedFieldOfView] = framedFieldOfView;\n\n      if (this[$initialized]) {\n        this[$maintainThetaPhi] = true;\n      } else {\n        this[$initialized] = true;\n      }\n      this.requestUpdate('maxFieldOfView', this.maxFieldOfView);\n      this.requestUpdate('fieldOfView', this.fieldOfView);\n      this.requestUpdate('minCameraOrbit', this.minCameraOrbit);\n      this.requestUpdate('maxCameraOrbit', this.maxCameraOrbit);\n      this.requestUpdate('cameraOrbit', this.cameraOrbit);\n      this.requestUpdate('cameraTarget', this.cameraTarget);\n      this.jumpCameraToGoal();\n    }\n\n    [$onFocus] = () => {\n      const input = this[$userInputElement];\n\n      if (!isFinite(this[$focusedTime])) {\n        this[$focusedTime] = performance.now();\n      }\n\n      // NOTE(cdata): On every re-focus, we switch the aria-label back to\n      // the original, non-prompt label if appropriate. If the user has\n      // already interacted, they no longer need to hear the prompt.\n      // Otherwise, they will hear it again after the idle prompt threshold\n      // has been crossed.\n      const ariaLabel = this[$ariaLabel];\n\n      if (input.getAttribute('aria-label') !== ariaLabel) {\n        input.setAttribute('aria-label', ariaLabel);\n      }\n\n      if (this.interactionPrompt === InteractionPromptStrategy.WHEN_FOCUSED &&\n          !this[$userHasInteracted]) {\n        this[$waitingToPromptUser] = true;\n      }\n    };\n\n    [$onBlur] = () => {\n      if (this.interactionPrompt !== InteractionPromptStrategy.WHEN_FOCUSED) {\n        return;\n      }\n\n      this[$waitingToPromptUser] = false;\n      this[$promptElement].classList.remove('visible');\n\n      this[$promptElementVisibleTime] = Infinity;\n      this[$focusedTime] = Infinity;\n    };\n\n    [$onChange] = ({source}: ChangeEvent) => {\n      this[$updateAria]();\n      this[$needsRender]();\n\n      if (source === ChangeSource.USER_INTERACTION) {\n        this[$userHasInteracted] = true;\n        this[$deferInteractionPrompt]();\n      }\n\n      this.dispatchEvent(new CustomEvent<CameraChangeDetails>(\n          'camera-change', {detail: {source}}));\n    };\n\n    [$onPointerChange] = (event: PointerChangeEvent) => {\n      if (event.type === 'pointer-change-start') {\n        this[$container].classList.add('pointer-tumbling');\n      } else {\n        this[$container].classList.remove('pointer-tumbling');\n      }\n    };\n  }\n\n  return ControlsModelViewerElement;\n};\n"]}