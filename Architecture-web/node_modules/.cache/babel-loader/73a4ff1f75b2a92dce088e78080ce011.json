{"ast":null,"code":"import _extends from '@babel/runtime/helpers/esm/extends';\nimport _objectWithoutPropertiesLoose from '@babel/runtime/helpers/esm/objectWithoutPropertiesLoose';\nimport React, { forwardRef, useRef, useMemo } from 'react';\nimport { useThree, useFrame } from 'react-three-fiber';\nimport { WebGLRenderTarget, PlaneBufferGeometry, Mesh, MeshDepthMaterial, ShaderMaterial } from 'three';\nimport { HorizontalBlurShader } from 'three/examples/jsm/shaders/HorizontalBlurShader';\nimport { VerticalBlurShader } from 'three/examples/jsm/shaders/VerticalBlurShader';\nconst ContactShadows = /*#__PURE__*/forwardRef((_ref, ref) => {\n  let {\n    opacity = 1,\n    width = 1,\n    height = 1,\n    blur = 1,\n    far = 10,\n    resolution = 256\n  } = _ref,\n      props = _objectWithoutPropertiesLoose(_ref, [\"opacity\", \"width\", \"height\", \"blur\", \"far\", \"resolution\"]);\n\n  const {\n    scene,\n    gl\n  } = useThree();\n  const shadowCamera = useRef();\n  const [renderTarget, planeGeometry, depthMaterial, blurPlane, horizontalBlurMaterial, verticalBlurMaterial, renderTargetBlur] = useMemo(() => {\n    const renderTarget = new WebGLRenderTarget(resolution, resolution);\n    const renderTargetBlur = new WebGLRenderTarget(resolution, resolution);\n    renderTargetBlur.texture.generateMipmaps = renderTarget.texture.generateMipmaps = false;\n    const planeGeometry = new PlaneBufferGeometry(width, height).rotateX(Math.PI / 2);\n    const blurPlane = new Mesh(planeGeometry);\n    const depthMaterial = new MeshDepthMaterial();\n    depthMaterial.depthTest = depthMaterial.depthWrite = false;\n\n    depthMaterial.onBeforeCompile = shader => shader.fragmentShader = shader.fragmentShader.replace('1.0 - fragCoordZ ), opacity );', '0.0 ), ( 1.0 - fragCoordZ ) * 1.0 );');\n\n    const horizontalBlurMaterial = new ShaderMaterial(HorizontalBlurShader);\n    const verticalBlurMaterial = new ShaderMaterial(VerticalBlurShader);\n    verticalBlurMaterial.depthTest = horizontalBlurMaterial.depthTest = false;\n    return [renderTarget, planeGeometry, depthMaterial, blurPlane, horizontalBlurMaterial, verticalBlurMaterial, renderTargetBlur];\n  }, [resolution, width, height]);\n  useFrame(() => {\n    if (shadowCamera.current) {\n      const initialBackground = scene.background;\n      scene.background = null;\n      scene.overrideMaterial = depthMaterial;\n      gl.setRenderTarget(renderTarget);\n      gl.render(scene, shadowCamera.current);\n      scene.overrideMaterial = null;\n      blurPlane.material = horizontalBlurMaterial;\n      blurPlane.material.uniforms.tDiffuse.value = renderTarget.texture;\n      horizontalBlurMaterial.uniforms.h.value = blur / 256;\n      gl.setRenderTarget(renderTargetBlur);\n      gl.render(blurPlane, shadowCamera.current);\n      blurPlane.material = verticalBlurMaterial;\n      blurPlane.material.uniforms.tDiffuse.value = renderTargetBlur.texture;\n      verticalBlurMaterial.uniforms.v.value = blur / 256;\n      gl.setRenderTarget(renderTarget);\n      gl.render(blurPlane, shadowCamera.current);\n      gl.setRenderTarget(null);\n      scene.background = initialBackground;\n    }\n  });\n  return /*#__PURE__*/React.createElement(\"group\", _extends({}, props, {\n    ref: ref\n  }), /*#__PURE__*/React.createElement(\"mesh\", {\n    geometry: planeGeometry,\n    scale: [1, -1, 1],\n    rotation: [-Math.PI / 2, 0, 0]\n  }, /*#__PURE__*/React.createElement(\"meshBasicMaterial\", {\n    map: renderTarget.texture,\n    transparent: true,\n    opacity: opacity\n  })), /*#__PURE__*/React.createElement(\"orthographicCamera\", {\n    ref: shadowCamera,\n    args: [-width / 2, width / 2, height / 2, -height / 2, 0, far]\n  }));\n});\nexport { ContactShadows };","map":{"version":3,"sources":["/Users/haiakablan/Documents/לוטוס/קורס/Architecture-web/node_modules/drei/ContactShadows.js"],"names":["_extends","_objectWithoutPropertiesLoose","React","forwardRef","useRef","useMemo","useThree","useFrame","WebGLRenderTarget","PlaneBufferGeometry","Mesh","MeshDepthMaterial","ShaderMaterial","HorizontalBlurShader","VerticalBlurShader","ContactShadows","_ref","ref","opacity","width","height","blur","far","resolution","props","scene","gl","shadowCamera","renderTarget","planeGeometry","depthMaterial","blurPlane","horizontalBlurMaterial","verticalBlurMaterial","renderTargetBlur","texture","generateMipmaps","rotateX","Math","PI","depthTest","depthWrite","onBeforeCompile","shader","fragmentShader","replace","current","initialBackground","background","overrideMaterial","setRenderTarget","render","material","uniforms","tDiffuse","value","h","v","createElement","geometry","scale","rotation","map","transparent","args"],"mappings":"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","sourcesContent":["import _extends from '@babel/runtime/helpers/esm/extends';\nimport _objectWithoutPropertiesLoose from '@babel/runtime/helpers/esm/objectWithoutPropertiesLoose';\nimport React, { forwardRef, useRef, useMemo } from 'react';\nimport { useThree, useFrame } from 'react-three-fiber';\nimport { WebGLRenderTarget, PlaneBufferGeometry, Mesh, MeshDepthMaterial, ShaderMaterial } from 'three';\nimport { HorizontalBlurShader } from 'three/examples/jsm/shaders/HorizontalBlurShader';\nimport { VerticalBlurShader } from 'three/examples/jsm/shaders/VerticalBlurShader';\n\nconst ContactShadows = /*#__PURE__*/forwardRef((_ref, ref) => {\n  let {\n    opacity = 1,\n    width = 1,\n    height = 1,\n    blur = 1,\n    far = 10,\n    resolution = 256\n  } = _ref,\n      props = _objectWithoutPropertiesLoose(_ref, [\"opacity\", \"width\", \"height\", \"blur\", \"far\", \"resolution\"]);\n\n  const {\n    scene,\n    gl\n  } = useThree();\n  const shadowCamera = useRef();\n  const [renderTarget, planeGeometry, depthMaterial, blurPlane, horizontalBlurMaterial, verticalBlurMaterial, renderTargetBlur] = useMemo(() => {\n    const renderTarget = new WebGLRenderTarget(resolution, resolution);\n    const renderTargetBlur = new WebGLRenderTarget(resolution, resolution);\n    renderTargetBlur.texture.generateMipmaps = renderTarget.texture.generateMipmaps = false;\n    const planeGeometry = new PlaneBufferGeometry(width, height).rotateX(Math.PI / 2);\n    const blurPlane = new Mesh(planeGeometry);\n    const depthMaterial = new MeshDepthMaterial();\n    depthMaterial.depthTest = depthMaterial.depthWrite = false;\n\n    depthMaterial.onBeforeCompile = shader => shader.fragmentShader = shader.fragmentShader.replace('1.0 - fragCoordZ ), opacity );', '0.0 ), ( 1.0 - fragCoordZ ) * 1.0 );');\n\n    const horizontalBlurMaterial = new ShaderMaterial(HorizontalBlurShader);\n    const verticalBlurMaterial = new ShaderMaterial(VerticalBlurShader);\n    verticalBlurMaterial.depthTest = horizontalBlurMaterial.depthTest = false;\n    return [renderTarget, planeGeometry, depthMaterial, blurPlane, horizontalBlurMaterial, verticalBlurMaterial, renderTargetBlur];\n  }, [resolution, width, height]);\n  useFrame(() => {\n    if (shadowCamera.current) {\n      const initialBackground = scene.background;\n      scene.background = null;\n      scene.overrideMaterial = depthMaterial;\n      gl.setRenderTarget(renderTarget);\n      gl.render(scene, shadowCamera.current);\n      scene.overrideMaterial = null;\n      blurPlane.material = horizontalBlurMaterial;\n      blurPlane.material.uniforms.tDiffuse.value = renderTarget.texture;\n      horizontalBlurMaterial.uniforms.h.value = blur / 256;\n      gl.setRenderTarget(renderTargetBlur);\n      gl.render(blurPlane, shadowCamera.current);\n      blurPlane.material = verticalBlurMaterial;\n      blurPlane.material.uniforms.tDiffuse.value = renderTargetBlur.texture;\n      verticalBlurMaterial.uniforms.v.value = blur / 256;\n      gl.setRenderTarget(renderTarget);\n      gl.render(blurPlane, shadowCamera.current);\n      gl.setRenderTarget(null);\n      scene.background = initialBackground;\n    }\n  });\n  return /*#__PURE__*/React.createElement(\"group\", _extends({}, props, {\n    ref: ref\n  }), /*#__PURE__*/React.createElement(\"mesh\", {\n    geometry: planeGeometry,\n    scale: [1, -1, 1],\n    rotation: [-Math.PI / 2, 0, 0]\n  }, /*#__PURE__*/React.createElement(\"meshBasicMaterial\", {\n    map: renderTarget.texture,\n    transparent: true,\n    opacity: opacity\n  })), /*#__PURE__*/React.createElement(\"orthographicCamera\", {\n    ref: shadowCamera,\n    args: [-width / 2, width / 2, height / 2, -height / 2, 0, far]\n  }));\n});\n\nexport { ContactShadows };\n"]},"metadata":{},"sourceType":"module"}