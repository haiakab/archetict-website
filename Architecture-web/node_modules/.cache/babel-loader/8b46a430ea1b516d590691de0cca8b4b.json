{"ast":null,"code":"import _defineProperty from '@babel/runtime/helpers/esm/defineProperty';\nimport { EventDispatcher, MOUSE, Vector3, Vector2, Quaternion } from 'three';\n\nclass TrackballControls extends EventDispatcher {\n  // internals\n  // events\n  constructor(object, domElement) {\n    super();\n\n    _defineProperty(this, \"enabled\", true);\n\n    _defineProperty(this, \"screen\", {\n      left: 0,\n      top: 0,\n      width: 0,\n      height: 0\n    });\n\n    _defineProperty(this, \"rotateSpeed\", 1.0);\n\n    _defineProperty(this, \"zoomSpeed\", 1.2);\n\n    _defineProperty(this, \"panSpeed\", 0.3);\n\n    _defineProperty(this, \"noRotate\", false);\n\n    _defineProperty(this, \"noZoom\", false);\n\n    _defineProperty(this, \"noPan\", false);\n\n    _defineProperty(this, \"staticMoving\", false);\n\n    _defineProperty(this, \"dynamicDampingFactor\", 0.2);\n\n    _defineProperty(this, \"minDistance\", 0);\n\n    _defineProperty(this, \"maxDistance\", Infinity);\n\n    _defineProperty(this, \"keys\", [65\n    /*A*/\n    , 83\n    /*S*/\n    , 68\n    /*D*/\n    ]);\n\n    _defineProperty(this, \"mouseButtons\", {\n      LEFT: MOUSE.ROTATE,\n      MIDDLE: MOUSE.DOLLY,\n      RIGHT: MOUSE.PAN\n    });\n\n    _defineProperty(this, \"object\", void 0);\n\n    _defineProperty(this, \"domElement\", void 0);\n\n    _defineProperty(this, \"target\", new Vector3());\n\n    _defineProperty(this, \"STATE\", {\n      NONE: -1,\n      ROTATE: 0,\n      ZOOM: 1,\n      PAN: 2,\n      TOUCH_ROTATE: 3,\n      TOUCH_ZOOM_PAN: 4\n    });\n\n    _defineProperty(this, \"EPS\", 0.000001);\n\n    _defineProperty(this, \"lastPosition\", new Vector3());\n\n    _defineProperty(this, \"lastZoom\", 1);\n\n    _defineProperty(this, \"_state\", this.STATE.NONE);\n\n    _defineProperty(this, \"_keyState\", this.STATE.NONE);\n\n    _defineProperty(this, \"_eye\", new Vector3());\n\n    _defineProperty(this, \"_movePrev\", new Vector2());\n\n    _defineProperty(this, \"_moveCurr\", new Vector2());\n\n    _defineProperty(this, \"_lastAxis\", new Vector3());\n\n    _defineProperty(this, \"_lastAngle\", 0);\n\n    _defineProperty(this, \"_zoomStart\", new Vector2());\n\n    _defineProperty(this, \"_zoomEnd\", new Vector2());\n\n    _defineProperty(this, \"_touchZoomDistanceStart\", 0);\n\n    _defineProperty(this, \"_touchZoomDistanceEnd\", 0);\n\n    _defineProperty(this, \"_panStart\", new Vector2());\n\n    _defineProperty(this, \"_panEnd\", new Vector2());\n\n    _defineProperty(this, \"target0\", void 0);\n\n    _defineProperty(this, \"position0\", void 0);\n\n    _defineProperty(this, \"up0\", void 0);\n\n    _defineProperty(this, \"zoom0\", void 0);\n\n    _defineProperty(this, \"changeEvent\", {\n      type: 'change'\n    });\n\n    _defineProperty(this, \"startEvent\", {\n      type: 'start'\n    });\n\n    _defineProperty(this, \"endEvent\", {\n      type: 'end'\n    });\n\n    _defineProperty(this, \"onScreenVector\", new Vector2());\n\n    _defineProperty(this, \"getMouseOnScreen\", (pageX, pageY) => {\n      this.onScreenVector.set((pageX - this.screen.left) / this.screen.width, (pageY - this.screen.top) / this.screen.height);\n      return this.onScreenVector;\n    });\n\n    _defineProperty(this, \"onCircleVector\", new Vector2());\n\n    _defineProperty(this, \"getMouseOnCircle\", (pageX, pageY) => {\n      this.onCircleVector.set((pageX - this.screen.width * 0.5 - this.screen.left) / (this.screen.width * 0.5), (this.screen.height + 2 * (this.screen.top - pageY)) / this.screen.width // screen.width intentional\n      );\n      return this.onCircleVector;\n    });\n\n    _defineProperty(this, \"axis\", new Vector3());\n\n    _defineProperty(this, \"quaternion\", new Quaternion());\n\n    _defineProperty(this, \"eyeDirection\", new Vector3());\n\n    _defineProperty(this, \"objectUpDirection\", new Vector3());\n\n    _defineProperty(this, \"objectSidewaysDirection\", new Vector3());\n\n    _defineProperty(this, \"moveDirection\", new Vector3());\n\n    _defineProperty(this, \"angle\", 0);\n\n    _defineProperty(this, \"rotateCamera\", () => {\n      this.moveDirection.set(this._moveCurr.x - this._movePrev.x, this._moveCurr.y - this._movePrev.y, 0);\n      this.angle = this.moveDirection.length();\n\n      if (this.angle) {\n        this._eye.copy(this.object.position).sub(this.target);\n\n        this.eyeDirection.copy(this._eye).normalize();\n        this.objectUpDirection.copy(this.object.up).normalize();\n        this.objectSidewaysDirection.crossVectors(this.objectUpDirection, this.eyeDirection).normalize();\n        this.objectUpDirection.setLength(this._moveCurr.y - this._movePrev.y);\n        this.objectSidewaysDirection.setLength(this._moveCurr.x - this._movePrev.x);\n        this.moveDirection.copy(this.objectUpDirection.add(this.objectSidewaysDirection));\n        this.axis.crossVectors(this.moveDirection, this._eye).normalize();\n        this.angle *= this.rotateSpeed;\n        this.quaternion.setFromAxisAngle(this.axis, this.angle);\n\n        this._eye.applyQuaternion(this.quaternion);\n\n        this.object.up.applyQuaternion(this.quaternion);\n\n        this._lastAxis.copy(this.axis);\n\n        this._lastAngle = this.angle;\n      } else if (!this.staticMoving && this._lastAngle) {\n        this._lastAngle *= Math.sqrt(1.0 - this.dynamicDampingFactor);\n\n        this._eye.copy(this.object.position).sub(this.target);\n\n        this.quaternion.setFromAxisAngle(this._lastAxis, this._lastAngle);\n\n        this._eye.applyQuaternion(this.quaternion);\n\n        this.object.up.applyQuaternion(this.quaternion);\n      }\n\n      this._movePrev.copy(this._moveCurr);\n    });\n\n    _defineProperty(this, \"zoomCamera\", () => {\n      let factor;\n\n      if (this._state === this.STATE.TOUCH_ZOOM_PAN) {\n        factor = this._touchZoomDistanceStart / this._touchZoomDistanceEnd;\n        this._touchZoomDistanceStart = this._touchZoomDistanceEnd;\n\n        if (this.object.isPerspectiveCamera) {\n          this._eye.multiplyScalar(factor);\n        } else if (this.object.isOrthographicCamera) {\n          this.object.zoom *= factor;\n          this.object.updateProjectionMatrix();\n        } else {\n          console.warn('THREE.TrackballControls: Unsupported camera type');\n        }\n      } else {\n        factor = 1.0 + (this._zoomEnd.y - this._zoomStart.y) * this.zoomSpeed;\n\n        if (factor !== 1.0 && factor > 0.0) {\n          if (this.object.isPerspectiveCamera) {\n            this._eye.multiplyScalar(factor);\n          } else if (this.object.isOrthographicCamera) {\n            this.object.zoom /= factor;\n            this.object.updateProjectionMatrix();\n          } else {\n            console.warn('THREE.TrackballControls: Unsupported camera type');\n          }\n        }\n\n        if (this.staticMoving) {\n          this._zoomStart.copy(this._zoomEnd);\n        } else {\n          this._zoomStart.y += (this._zoomEnd.y - this._zoomStart.y) * this.dynamicDampingFactor;\n        }\n      }\n    });\n\n    _defineProperty(this, \"mouseChange\", new Vector2());\n\n    _defineProperty(this, \"objectUp\", new Vector3());\n\n    _defineProperty(this, \"pan\", new Vector3());\n\n    _defineProperty(this, \"panCamera\", () => {\n      this.mouseChange.copy(this._panEnd).sub(this._panStart);\n\n      if (this.mouseChange.lengthSq()) {\n        if (this.object.isOrthographicCamera) {\n          const orthoObject = this.object;\n          const scale_x = (orthoObject.right - orthoObject.left) / this.object.zoom / this.domElement.clientWidth;\n          const scale_y = (orthoObject.top - orthoObject.bottom) / this.object.zoom / this.domElement.clientWidth;\n          this.mouseChange.x *= scale_x;\n          this.mouseChange.y *= scale_y;\n        }\n\n        this.mouseChange.multiplyScalar(this._eye.length() * this.panSpeed);\n        this.pan.copy(this._eye).cross(this.object.up).setLength(this.mouseChange.x);\n        this.pan.add(this.objectUp.copy(this.object.up).setLength(this.mouseChange.y));\n        this.object.position.add(this.pan);\n        this.target.add(this.pan);\n\n        if (this.staticMoving) {\n          this._panStart.copy(this._panEnd);\n        } else {\n          this._panStart.add(this.mouseChange.subVectors(this._panEnd, this._panStart).multiplyScalar(this.dynamicDampingFactor));\n        }\n      }\n    });\n\n    _defineProperty(this, \"checkDistances\", () => {\n      if (!this.noZoom || !this.noPan) {\n        if (this._eye.lengthSq() > this.maxDistance * this.maxDistance) {\n          this.object.position.addVectors(this.target, this._eye.setLength(this.maxDistance));\n\n          this._zoomStart.copy(this._zoomEnd);\n        }\n\n        if (this._eye.lengthSq() < this.minDistance * this.minDistance) {\n          this.object.position.addVectors(this.target, this._eye.setLength(this.minDistance));\n\n          this._zoomStart.copy(this._zoomEnd);\n        }\n      }\n    });\n\n    _defineProperty(this, \"handleResize\", () => {\n      const box = this.domElement.getBoundingClientRect(); // adjustments come from similar code in the jquery offset() function\n\n      const d = this.domElement.ownerDocument.documentElement;\n      this.screen.left = box.left + window.pageXOffset - d.clientLeft;\n      this.screen.top = box.top + window.pageYOffset - d.clientTop;\n      this.screen.width = box.width;\n      this.screen.height = box.height;\n    });\n\n    _defineProperty(this, \"update\", () => {\n      this._eye.subVectors(this.object.position, this.target);\n\n      if (!this.noRotate) {\n        this.rotateCamera();\n      }\n\n      if (!this.noZoom) {\n        this.zoomCamera();\n      }\n\n      if (!this.noPan) {\n        this.panCamera();\n      }\n\n      this.object.position.addVectors(this.target, this._eye);\n\n      if (this.object.isPerspectiveCamera) {\n        this.checkDistances();\n        this.object.lookAt(this.target);\n\n        if (this.lastPosition.distanceToSquared(this.object.position) > this.EPS) {\n          this.dispatchEvent(this.changeEvent);\n          this.lastPosition.copy(this.object.position);\n        }\n      } else if (this.object.isOrthographicCamera) {\n        this.object.lookAt(this.target);\n\n        if (this.lastPosition.distanceToSquared(this.object.position) > this.EPS || this.lastZoom !== this.object.zoom) {\n          this.dispatchEvent(this.changeEvent);\n          this.lastPosition.copy(this.object.position);\n          this.lastZoom = this.object.zoom;\n        }\n      } else {\n        console.warn('THREE.TrackballControls: Unsupported camera type');\n      }\n    });\n\n    _defineProperty(this, \"reset\", () => {\n      this._state = this.STATE.NONE;\n      this._keyState = this.STATE.NONE;\n      this.target.copy(this.target0);\n      this.object.position.copy(this.position0);\n      this.object.up.copy(this.up0);\n      this.object.zoom = this.zoom0;\n      this.object.updateProjectionMatrix();\n\n      this._eye.subVectors(this.object.position, this.target);\n\n      this.object.lookAt(this.target);\n      this.dispatchEvent(this.changeEvent);\n      this.lastPosition.copy(this.object.position);\n      this.lastZoom = this.object.zoom;\n    });\n\n    _defineProperty(this, \"keydown\", event => {\n      if (this.enabled === false) return;\n      window.removeEventListener('keydown', this.keydown);\n\n      if (this._keyState !== this.STATE.NONE) {\n        return;\n      } else if (event.keyCode === this.keys[this.STATE.ROTATE] && !this.noRotate) {\n        this._keyState = this.STATE.ROTATE;\n      } else if (event.keyCode === this.keys[this.STATE.ZOOM] && !this.noZoom) {\n        this._keyState = this.STATE.ZOOM;\n      } else if (event.keyCode === this.keys[this.STATE.PAN] && !this.noPan) {\n        this._keyState = this.STATE.PAN;\n      }\n    });\n\n    _defineProperty(this, \"onPointerDown\", event => {\n      if (this.enabled === false) return;\n\n      switch (event.pointerType) {\n        case 'mouse':\n        case 'pen':\n          this.onMouseDown(event);\n          break;\n        // TODO touch\n      }\n    });\n\n    _defineProperty(this, \"onPointerMove\", event => {\n      if (this.enabled === false) return;\n\n      switch (event.pointerType) {\n        case 'mouse':\n        case 'pen':\n          this.onMouseMove(event);\n          break;\n        // TODO touch\n      }\n    });\n\n    _defineProperty(this, \"onPointerUp\", event => {\n      if (this.enabled === false) return;\n\n      switch (event.pointerType) {\n        case 'mouse':\n        case 'pen':\n          this.onMouseUp(event);\n          break;\n        // TODO touch\n      }\n    });\n\n    _defineProperty(this, \"keyup\", () => {\n      if (this.enabled === false) return;\n      this._keyState = this.STATE.NONE;\n      window.addEventListener('keydown', this.keydown);\n    });\n\n    _defineProperty(this, \"onMouseDown\", event => {\n      event.preventDefault();\n\n      if (this._state === this.STATE.NONE) {\n        switch (event.button) {\n          case this.mouseButtons.LEFT:\n            this._state = this.STATE.ROTATE;\n            break;\n\n          case this.mouseButtons.MIDDLE:\n            this._state = this.STATE.ZOOM;\n            break;\n\n          case this.mouseButtons.RIGHT:\n            this._state = this.STATE.PAN;\n            break;\n\n          default:\n            this._state = this.STATE.NONE;\n        }\n      }\n\n      const state = this._keyState !== this.STATE.NONE ? this._keyState : this._state;\n\n      if (state === this.STATE.ROTATE && !this.noRotate) {\n        this._moveCurr.copy(this.getMouseOnCircle(event.pageX, event.pageY));\n\n        this._movePrev.copy(this._moveCurr);\n      } else if (state === this.STATE.ZOOM && !this.noZoom) {\n        this._zoomStart.copy(this.getMouseOnScreen(event.pageX, event.pageY));\n\n        this._zoomEnd.copy(this._zoomStart);\n      } else if (state === this.STATE.PAN && !this.noPan) {\n        this._panStart.copy(this.getMouseOnScreen(event.pageX, event.pageY));\n\n        this._panEnd.copy(this._panStart);\n      }\n\n      this.domElement.ownerDocument.addEventListener('pointermove', this.onPointerMove);\n      this.domElement.ownerDocument.addEventListener('pointerup', this.onPointerUp);\n      this.dispatchEvent(this.startEvent);\n    });\n\n    _defineProperty(this, \"onMouseMove\", event => {\n      if (this.enabled === false) return;\n      event.preventDefault();\n      const state = this._keyState !== this.STATE.NONE ? this._keyState : this._state;\n\n      if (state === this.STATE.ROTATE && !this.noRotate) {\n        this._movePrev.copy(this._moveCurr);\n\n        this._moveCurr.copy(this.getMouseOnCircle(event.pageX, event.pageY));\n      } else if (state === this.STATE.ZOOM && !this.noZoom) {\n        this._zoomEnd.copy(this.getMouseOnScreen(event.pageX, event.pageY));\n      } else if (state === this.STATE.PAN && !this.noPan) {\n        this._panEnd.copy(this.getMouseOnScreen(event.pageX, event.pageY));\n      }\n    });\n\n    _defineProperty(this, \"onMouseUp\", event => {\n      if (this.enabled === false) return;\n      event.preventDefault();\n      this._state = this.STATE.NONE;\n      this.domElement.ownerDocument.removeEventListener('pointermove', this.onPointerMove);\n      this.domElement.ownerDocument.removeEventListener('pointerup', this.onPointerUp);\n      this.dispatchEvent(this.endEvent);\n    });\n\n    _defineProperty(this, \"mousewheel\", event => {\n      if (this.enabled === false) return;\n      if (this.noZoom === true) return;\n      event.preventDefault();\n\n      switch (event.deltaMode) {\n        case 2:\n          // Zoom in pages\n          this._zoomStart.y -= event.deltaY * 0.025;\n          break;\n\n        case 1:\n          // Zoom in lines\n          this._zoomStart.y -= event.deltaY * 0.01;\n          break;\n\n        default:\n          // undefined, 0, assume pixels\n          this._zoomStart.y -= event.deltaY * 0.00025;\n          break;\n      }\n\n      this.dispatchEvent(this.startEvent);\n      this.dispatchEvent(this.endEvent);\n    });\n\n    _defineProperty(this, \"touchstart\", event => {\n      if (this.enabled === false) return;\n      event.preventDefault();\n\n      switch (event.touches.length) {\n        case 1:\n          this._state = this.STATE.TOUCH_ROTATE;\n\n          this._moveCurr.copy(this.getMouseOnCircle(event.touches[0].pageX, event.touches[0].pageY));\n\n          this._movePrev.copy(this._moveCurr);\n\n          break;\n\n        default:\n          // 2 or more\n          this._state = this.STATE.TOUCH_ZOOM_PAN;\n          const dx = event.touches[0].pageX - event.touches[1].pageX;\n          const dy = event.touches[0].pageY - event.touches[1].pageY;\n          this._touchZoomDistanceEnd = this._touchZoomDistanceStart = Math.sqrt(dx * dx + dy * dy);\n          const x = (event.touches[0].pageX + event.touches[1].pageX) / 2;\n          const y = (event.touches[0].pageY + event.touches[1].pageY) / 2;\n\n          this._panStart.copy(this.getMouseOnScreen(x, y));\n\n          this._panEnd.copy(this._panStart);\n\n          break;\n      }\n\n      this.dispatchEvent(this.startEvent);\n    });\n\n    _defineProperty(this, \"touchmove\", event => {\n      if (this.enabled === false) return;\n      event.preventDefault();\n\n      switch (event.touches.length) {\n        case 1:\n          this._movePrev.copy(this._moveCurr);\n\n          this._moveCurr.copy(this.getMouseOnCircle(event.touches[0].pageX, event.touches[0].pageY));\n\n          break;\n\n        default:\n          // 2 or more\n          const dx = event.touches[0].pageX - event.touches[1].pageX;\n          const dy = event.touches[0].pageY - event.touches[1].pageY;\n          this._touchZoomDistanceEnd = Math.sqrt(dx * dx + dy * dy);\n          const x = (event.touches[0].pageX + event.touches[1].pageX) / 2;\n          const y = (event.touches[0].pageY + event.touches[1].pageY) / 2;\n\n          this._panEnd.copy(this.getMouseOnScreen(x, y));\n\n          break;\n      }\n    });\n\n    _defineProperty(this, \"touchend\", event => {\n      if (this.enabled === false) return;\n\n      switch (event.touches.length) {\n        case 0:\n          this._state = this.STATE.NONE;\n          break;\n\n        case 1:\n          this._state = this.STATE.TOUCH_ROTATE;\n\n          this._moveCurr.copy(this.getMouseOnCircle(event.touches[0].pageX, event.touches[0].pageY));\n\n          this._movePrev.copy(this._moveCurr);\n\n          break;\n      }\n\n      this.dispatchEvent(this.endEvent);\n    });\n\n    _defineProperty(this, \"contextmenu\", event => {\n      if (this.enabled === false) return;\n      event.preventDefault();\n    });\n\n    _defineProperty(this, \"dispose\", () => {\n      this.domElement.removeEventListener('contextmenu', this.contextmenu);\n      this.domElement.removeEventListener('pointerdown', this.onPointerDown);\n      this.domElement.removeEventListener('wheel', this.mousewheel);\n      this.domElement.removeEventListener('touchstart', this.touchstart);\n      this.domElement.removeEventListener('touchend', this.touchend);\n      this.domElement.removeEventListener('touchmove', this.touchmove);\n      this.domElement.ownerDocument.removeEventListener('pointermove', this.onPointerMove);\n      this.domElement.ownerDocument.removeEventListener('pointerup', this.onPointerUp);\n      window.removeEventListener('keydown', this.keydown);\n      window.removeEventListener('keyup', this.keyup);\n    });\n\n    if (domElement === undefined) {\n      console.warn('THREE.TrackballControls: The second parameter \"domElement\" is now mandatory.');\n    }\n\n    this.object = object;\n    this.domElement = domElement; // for reset\n\n    this.target0 = this.target.clone();\n    this.position0 = this.object.position.clone();\n    this.up0 = this.object.up.clone();\n    this.zoom0 = this.object.zoom; // listeners\n\n    this.domElement.addEventListener('contextmenu', this.contextmenu);\n    this.domElement.addEventListener('pointerdown', this.onPointerDown);\n    this.domElement.addEventListener('wheel', this.mousewheel);\n    this.domElement.addEventListener('touchstart', this.touchstart);\n    this.domElement.addEventListener('touchend', this.touchend);\n    this.domElement.addEventListener('touchmove', this.touchmove);\n    this.domElement.ownerDocument.addEventListener('pointermove', this.onPointerMove);\n    this.domElement.ownerDocument.addEventListener('pointerup', this.onPointerUp);\n    window.addEventListener('keydown', this.keydown);\n    window.addEventListener('keyup', this.keyup);\n    this.handleResize(); // force an update at start\n\n    this.update();\n  }\n\n}\n\nexport { TrackballControls };","map":{"version":3,"sources":["/Users/haiakablan/Documents/לוטוס/קורס/Architecture-web/node_modules/three-stdlib/controls/TrackballControls.js"],"names":["_defineProperty","EventDispatcher","MOUSE","Vector3","Vector2","Quaternion","TrackballControls","constructor","object","domElement","left","top","width","height","Infinity","LEFT","ROTATE","MIDDLE","DOLLY","RIGHT","PAN","NONE","ZOOM","TOUCH_ROTATE","TOUCH_ZOOM_PAN","STATE","type","pageX","pageY","onScreenVector","set","screen","onCircleVector","moveDirection","_moveCurr","x","_movePrev","y","angle","length","_eye","copy","position","sub","target","eyeDirection","normalize","objectUpDirection","up","objectSidewaysDirection","crossVectors","setLength","add","axis","rotateSpeed","quaternion","setFromAxisAngle","applyQuaternion","_lastAxis","_lastAngle","staticMoving","Math","sqrt","dynamicDampingFactor","factor","_state","_touchZoomDistanceStart","_touchZoomDistanceEnd","isPerspectiveCamera","multiplyScalar","isOrthographicCamera","zoom","updateProjectionMatrix","console","warn","_zoomEnd","_zoomStart","zoomSpeed","mouseChange","_panEnd","_panStart","lengthSq","orthoObject","scale_x","right","clientWidth","scale_y","bottom","panSpeed","pan","cross","objectUp","subVectors","noZoom","noPan","maxDistance","addVectors","minDistance","box","getBoundingClientRect","d","ownerDocument","documentElement","window","pageXOffset","clientLeft","pageYOffset","clientTop","noRotate","rotateCamera","zoomCamera","panCamera","checkDistances","lookAt","lastPosition","distanceToSquared","EPS","dispatchEvent","changeEvent","lastZoom","_keyState","target0","position0","up0","zoom0","event","enabled","removeEventListener","keydown","keyCode","keys","pointerType","onMouseDown","onMouseMove","onMouseUp","addEventListener","preventDefault","button","mouseButtons","state","getMouseOnCircle","getMouseOnScreen","onPointerMove","onPointerUp","startEvent","endEvent","deltaMode","deltaY","touches","dx","dy","contextmenu","onPointerDown","mousewheel","touchstart","touchend","touchmove","keyup","undefined","clone","handleResize","update"],"mappings":"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","sourcesContent":["import _defineProperty from '@babel/runtime/helpers/esm/defineProperty';\nimport { EventDispatcher, MOUSE, Vector3, Vector2, Quaternion } from 'three';\n\nclass TrackballControls extends EventDispatcher {\n  // internals\n  // events\n  constructor(object, domElement) {\n    super();\n\n    _defineProperty(this, \"enabled\", true);\n\n    _defineProperty(this, \"screen\", {\n      left: 0,\n      top: 0,\n      width: 0,\n      height: 0\n    });\n\n    _defineProperty(this, \"rotateSpeed\", 1.0);\n\n    _defineProperty(this, \"zoomSpeed\", 1.2);\n\n    _defineProperty(this, \"panSpeed\", 0.3);\n\n    _defineProperty(this, \"noRotate\", false);\n\n    _defineProperty(this, \"noZoom\", false);\n\n    _defineProperty(this, \"noPan\", false);\n\n    _defineProperty(this, \"staticMoving\", false);\n\n    _defineProperty(this, \"dynamicDampingFactor\", 0.2);\n\n    _defineProperty(this, \"minDistance\", 0);\n\n    _defineProperty(this, \"maxDistance\", Infinity);\n\n    _defineProperty(this, \"keys\", [65\n    /*A*/\n    , 83\n    /*S*/\n    , 68\n    /*D*/\n    ]);\n\n    _defineProperty(this, \"mouseButtons\", {\n      LEFT: MOUSE.ROTATE,\n      MIDDLE: MOUSE.DOLLY,\n      RIGHT: MOUSE.PAN\n    });\n\n    _defineProperty(this, \"object\", void 0);\n\n    _defineProperty(this, \"domElement\", void 0);\n\n    _defineProperty(this, \"target\", new Vector3());\n\n    _defineProperty(this, \"STATE\", {\n      NONE: -1,\n      ROTATE: 0,\n      ZOOM: 1,\n      PAN: 2,\n      TOUCH_ROTATE: 3,\n      TOUCH_ZOOM_PAN: 4\n    });\n\n    _defineProperty(this, \"EPS\", 0.000001);\n\n    _defineProperty(this, \"lastPosition\", new Vector3());\n\n    _defineProperty(this, \"lastZoom\", 1);\n\n    _defineProperty(this, \"_state\", this.STATE.NONE);\n\n    _defineProperty(this, \"_keyState\", this.STATE.NONE);\n\n    _defineProperty(this, \"_eye\", new Vector3());\n\n    _defineProperty(this, \"_movePrev\", new Vector2());\n\n    _defineProperty(this, \"_moveCurr\", new Vector2());\n\n    _defineProperty(this, \"_lastAxis\", new Vector3());\n\n    _defineProperty(this, \"_lastAngle\", 0);\n\n    _defineProperty(this, \"_zoomStart\", new Vector2());\n\n    _defineProperty(this, \"_zoomEnd\", new Vector2());\n\n    _defineProperty(this, \"_touchZoomDistanceStart\", 0);\n\n    _defineProperty(this, \"_touchZoomDistanceEnd\", 0);\n\n    _defineProperty(this, \"_panStart\", new Vector2());\n\n    _defineProperty(this, \"_panEnd\", new Vector2());\n\n    _defineProperty(this, \"target0\", void 0);\n\n    _defineProperty(this, \"position0\", void 0);\n\n    _defineProperty(this, \"up0\", void 0);\n\n    _defineProperty(this, \"zoom0\", void 0);\n\n    _defineProperty(this, \"changeEvent\", {\n      type: 'change'\n    });\n\n    _defineProperty(this, \"startEvent\", {\n      type: 'start'\n    });\n\n    _defineProperty(this, \"endEvent\", {\n      type: 'end'\n    });\n\n    _defineProperty(this, \"onScreenVector\", new Vector2());\n\n    _defineProperty(this, \"getMouseOnScreen\", (pageX, pageY) => {\n      this.onScreenVector.set((pageX - this.screen.left) / this.screen.width, (pageY - this.screen.top) / this.screen.height);\n      return this.onScreenVector;\n    });\n\n    _defineProperty(this, \"onCircleVector\", new Vector2());\n\n    _defineProperty(this, \"getMouseOnCircle\", (pageX, pageY) => {\n      this.onCircleVector.set((pageX - this.screen.width * 0.5 - this.screen.left) / (this.screen.width * 0.5), (this.screen.height + 2 * (this.screen.top - pageY)) / this.screen.width // screen.width intentional\n      );\n      return this.onCircleVector;\n    });\n\n    _defineProperty(this, \"axis\", new Vector3());\n\n    _defineProperty(this, \"quaternion\", new Quaternion());\n\n    _defineProperty(this, \"eyeDirection\", new Vector3());\n\n    _defineProperty(this, \"objectUpDirection\", new Vector3());\n\n    _defineProperty(this, \"objectSidewaysDirection\", new Vector3());\n\n    _defineProperty(this, \"moveDirection\", new Vector3());\n\n    _defineProperty(this, \"angle\", 0);\n\n    _defineProperty(this, \"rotateCamera\", () => {\n      this.moveDirection.set(this._moveCurr.x - this._movePrev.x, this._moveCurr.y - this._movePrev.y, 0);\n      this.angle = this.moveDirection.length();\n\n      if (this.angle) {\n        this._eye.copy(this.object.position).sub(this.target);\n\n        this.eyeDirection.copy(this._eye).normalize();\n        this.objectUpDirection.copy(this.object.up).normalize();\n        this.objectSidewaysDirection.crossVectors(this.objectUpDirection, this.eyeDirection).normalize();\n        this.objectUpDirection.setLength(this._moveCurr.y - this._movePrev.y);\n        this.objectSidewaysDirection.setLength(this._moveCurr.x - this._movePrev.x);\n        this.moveDirection.copy(this.objectUpDirection.add(this.objectSidewaysDirection));\n        this.axis.crossVectors(this.moveDirection, this._eye).normalize();\n        this.angle *= this.rotateSpeed;\n        this.quaternion.setFromAxisAngle(this.axis, this.angle);\n\n        this._eye.applyQuaternion(this.quaternion);\n\n        this.object.up.applyQuaternion(this.quaternion);\n\n        this._lastAxis.copy(this.axis);\n\n        this._lastAngle = this.angle;\n      } else if (!this.staticMoving && this._lastAngle) {\n        this._lastAngle *= Math.sqrt(1.0 - this.dynamicDampingFactor);\n\n        this._eye.copy(this.object.position).sub(this.target);\n\n        this.quaternion.setFromAxisAngle(this._lastAxis, this._lastAngle);\n\n        this._eye.applyQuaternion(this.quaternion);\n\n        this.object.up.applyQuaternion(this.quaternion);\n      }\n\n      this._movePrev.copy(this._moveCurr);\n    });\n\n    _defineProperty(this, \"zoomCamera\", () => {\n      let factor;\n\n      if (this._state === this.STATE.TOUCH_ZOOM_PAN) {\n        factor = this._touchZoomDistanceStart / this._touchZoomDistanceEnd;\n        this._touchZoomDistanceStart = this._touchZoomDistanceEnd;\n\n        if (this.object.isPerspectiveCamera) {\n          this._eye.multiplyScalar(factor);\n        } else if (this.object.isOrthographicCamera) {\n          this.object.zoom *= factor;\n          this.object.updateProjectionMatrix();\n        } else {\n          console.warn('THREE.TrackballControls: Unsupported camera type');\n        }\n      } else {\n        factor = 1.0 + (this._zoomEnd.y - this._zoomStart.y) * this.zoomSpeed;\n\n        if (factor !== 1.0 && factor > 0.0) {\n          if (this.object.isPerspectiveCamera) {\n            this._eye.multiplyScalar(factor);\n          } else if (this.object.isOrthographicCamera) {\n            this.object.zoom /= factor;\n            this.object.updateProjectionMatrix();\n          } else {\n            console.warn('THREE.TrackballControls: Unsupported camera type');\n          }\n        }\n\n        if (this.staticMoving) {\n          this._zoomStart.copy(this._zoomEnd);\n        } else {\n          this._zoomStart.y += (this._zoomEnd.y - this._zoomStart.y) * this.dynamicDampingFactor;\n        }\n      }\n    });\n\n    _defineProperty(this, \"mouseChange\", new Vector2());\n\n    _defineProperty(this, \"objectUp\", new Vector3());\n\n    _defineProperty(this, \"pan\", new Vector3());\n\n    _defineProperty(this, \"panCamera\", () => {\n      this.mouseChange.copy(this._panEnd).sub(this._panStart);\n\n      if (this.mouseChange.lengthSq()) {\n        if (this.object.isOrthographicCamera) {\n          const orthoObject = this.object;\n          const scale_x = (orthoObject.right - orthoObject.left) / this.object.zoom / this.domElement.clientWidth;\n          const scale_y = (orthoObject.top - orthoObject.bottom) / this.object.zoom / this.domElement.clientWidth;\n          this.mouseChange.x *= scale_x;\n          this.mouseChange.y *= scale_y;\n        }\n\n        this.mouseChange.multiplyScalar(this._eye.length() * this.panSpeed);\n        this.pan.copy(this._eye).cross(this.object.up).setLength(this.mouseChange.x);\n        this.pan.add(this.objectUp.copy(this.object.up).setLength(this.mouseChange.y));\n        this.object.position.add(this.pan);\n        this.target.add(this.pan);\n\n        if (this.staticMoving) {\n          this._panStart.copy(this._panEnd);\n        } else {\n          this._panStart.add(this.mouseChange.subVectors(this._panEnd, this._panStart).multiplyScalar(this.dynamicDampingFactor));\n        }\n      }\n    });\n\n    _defineProperty(this, \"checkDistances\", () => {\n      if (!this.noZoom || !this.noPan) {\n        if (this._eye.lengthSq() > this.maxDistance * this.maxDistance) {\n          this.object.position.addVectors(this.target, this._eye.setLength(this.maxDistance));\n\n          this._zoomStart.copy(this._zoomEnd);\n        }\n\n        if (this._eye.lengthSq() < this.minDistance * this.minDistance) {\n          this.object.position.addVectors(this.target, this._eye.setLength(this.minDistance));\n\n          this._zoomStart.copy(this._zoomEnd);\n        }\n      }\n    });\n\n    _defineProperty(this, \"handleResize\", () => {\n      const box = this.domElement.getBoundingClientRect(); // adjustments come from similar code in the jquery offset() function\n\n      const d = this.domElement.ownerDocument.documentElement;\n      this.screen.left = box.left + window.pageXOffset - d.clientLeft;\n      this.screen.top = box.top + window.pageYOffset - d.clientTop;\n      this.screen.width = box.width;\n      this.screen.height = box.height;\n    });\n\n    _defineProperty(this, \"update\", () => {\n      this._eye.subVectors(this.object.position, this.target);\n\n      if (!this.noRotate) {\n        this.rotateCamera();\n      }\n\n      if (!this.noZoom) {\n        this.zoomCamera();\n      }\n\n      if (!this.noPan) {\n        this.panCamera();\n      }\n\n      this.object.position.addVectors(this.target, this._eye);\n\n      if (this.object.isPerspectiveCamera) {\n        this.checkDistances();\n        this.object.lookAt(this.target);\n\n        if (this.lastPosition.distanceToSquared(this.object.position) > this.EPS) {\n          this.dispatchEvent(this.changeEvent);\n          this.lastPosition.copy(this.object.position);\n        }\n      } else if (this.object.isOrthographicCamera) {\n        this.object.lookAt(this.target);\n\n        if (this.lastPosition.distanceToSquared(this.object.position) > this.EPS || this.lastZoom !== this.object.zoom) {\n          this.dispatchEvent(this.changeEvent);\n          this.lastPosition.copy(this.object.position);\n          this.lastZoom = this.object.zoom;\n        }\n      } else {\n        console.warn('THREE.TrackballControls: Unsupported camera type');\n      }\n    });\n\n    _defineProperty(this, \"reset\", () => {\n      this._state = this.STATE.NONE;\n      this._keyState = this.STATE.NONE;\n      this.target.copy(this.target0);\n      this.object.position.copy(this.position0);\n      this.object.up.copy(this.up0);\n      this.object.zoom = this.zoom0;\n      this.object.updateProjectionMatrix();\n\n      this._eye.subVectors(this.object.position, this.target);\n\n      this.object.lookAt(this.target);\n      this.dispatchEvent(this.changeEvent);\n      this.lastPosition.copy(this.object.position);\n      this.lastZoom = this.object.zoom;\n    });\n\n    _defineProperty(this, \"keydown\", event => {\n      if (this.enabled === false) return;\n      window.removeEventListener('keydown', this.keydown);\n\n      if (this._keyState !== this.STATE.NONE) {\n        return;\n      } else if (event.keyCode === this.keys[this.STATE.ROTATE] && !this.noRotate) {\n        this._keyState = this.STATE.ROTATE;\n      } else if (event.keyCode === this.keys[this.STATE.ZOOM] && !this.noZoom) {\n        this._keyState = this.STATE.ZOOM;\n      } else if (event.keyCode === this.keys[this.STATE.PAN] && !this.noPan) {\n        this._keyState = this.STATE.PAN;\n      }\n    });\n\n    _defineProperty(this, \"onPointerDown\", event => {\n      if (this.enabled === false) return;\n\n      switch (event.pointerType) {\n        case 'mouse':\n        case 'pen':\n          this.onMouseDown(event);\n          break;\n        // TODO touch\n      }\n    });\n\n    _defineProperty(this, \"onPointerMove\", event => {\n      if (this.enabled === false) return;\n\n      switch (event.pointerType) {\n        case 'mouse':\n        case 'pen':\n          this.onMouseMove(event);\n          break;\n        // TODO touch\n      }\n    });\n\n    _defineProperty(this, \"onPointerUp\", event => {\n      if (this.enabled === false) return;\n\n      switch (event.pointerType) {\n        case 'mouse':\n        case 'pen':\n          this.onMouseUp(event);\n          break;\n        // TODO touch\n      }\n    });\n\n    _defineProperty(this, \"keyup\", () => {\n      if (this.enabled === false) return;\n      this._keyState = this.STATE.NONE;\n      window.addEventListener('keydown', this.keydown);\n    });\n\n    _defineProperty(this, \"onMouseDown\", event => {\n      event.preventDefault();\n\n      if (this._state === this.STATE.NONE) {\n        switch (event.button) {\n          case this.mouseButtons.LEFT:\n            this._state = this.STATE.ROTATE;\n            break;\n\n          case this.mouseButtons.MIDDLE:\n            this._state = this.STATE.ZOOM;\n            break;\n\n          case this.mouseButtons.RIGHT:\n            this._state = this.STATE.PAN;\n            break;\n\n          default:\n            this._state = this.STATE.NONE;\n        }\n      }\n\n      const state = this._keyState !== this.STATE.NONE ? this._keyState : this._state;\n\n      if (state === this.STATE.ROTATE && !this.noRotate) {\n        this._moveCurr.copy(this.getMouseOnCircle(event.pageX, event.pageY));\n\n        this._movePrev.copy(this._moveCurr);\n      } else if (state === this.STATE.ZOOM && !this.noZoom) {\n        this._zoomStart.copy(this.getMouseOnScreen(event.pageX, event.pageY));\n\n        this._zoomEnd.copy(this._zoomStart);\n      } else if (state === this.STATE.PAN && !this.noPan) {\n        this._panStart.copy(this.getMouseOnScreen(event.pageX, event.pageY));\n\n        this._panEnd.copy(this._panStart);\n      }\n\n      this.domElement.ownerDocument.addEventListener('pointermove', this.onPointerMove);\n      this.domElement.ownerDocument.addEventListener('pointerup', this.onPointerUp);\n      this.dispatchEvent(this.startEvent);\n    });\n\n    _defineProperty(this, \"onMouseMove\", event => {\n      if (this.enabled === false) return;\n      event.preventDefault();\n      const state = this._keyState !== this.STATE.NONE ? this._keyState : this._state;\n\n      if (state === this.STATE.ROTATE && !this.noRotate) {\n        this._movePrev.copy(this._moveCurr);\n\n        this._moveCurr.copy(this.getMouseOnCircle(event.pageX, event.pageY));\n      } else if (state === this.STATE.ZOOM && !this.noZoom) {\n        this._zoomEnd.copy(this.getMouseOnScreen(event.pageX, event.pageY));\n      } else if (state === this.STATE.PAN && !this.noPan) {\n        this._panEnd.copy(this.getMouseOnScreen(event.pageX, event.pageY));\n      }\n    });\n\n    _defineProperty(this, \"onMouseUp\", event => {\n      if (this.enabled === false) return;\n      event.preventDefault();\n      this._state = this.STATE.NONE;\n      this.domElement.ownerDocument.removeEventListener('pointermove', this.onPointerMove);\n      this.domElement.ownerDocument.removeEventListener('pointerup', this.onPointerUp);\n      this.dispatchEvent(this.endEvent);\n    });\n\n    _defineProperty(this, \"mousewheel\", event => {\n      if (this.enabled === false) return;\n      if (this.noZoom === true) return;\n      event.preventDefault();\n\n      switch (event.deltaMode) {\n        case 2:\n          // Zoom in pages\n          this._zoomStart.y -= event.deltaY * 0.025;\n          break;\n\n        case 1:\n          // Zoom in lines\n          this._zoomStart.y -= event.deltaY * 0.01;\n          break;\n\n        default:\n          // undefined, 0, assume pixels\n          this._zoomStart.y -= event.deltaY * 0.00025;\n          break;\n      }\n\n      this.dispatchEvent(this.startEvent);\n      this.dispatchEvent(this.endEvent);\n    });\n\n    _defineProperty(this, \"touchstart\", event => {\n      if (this.enabled === false) return;\n      event.preventDefault();\n\n      switch (event.touches.length) {\n        case 1:\n          this._state = this.STATE.TOUCH_ROTATE;\n\n          this._moveCurr.copy(this.getMouseOnCircle(event.touches[0].pageX, event.touches[0].pageY));\n\n          this._movePrev.copy(this._moveCurr);\n\n          break;\n\n        default:\n          // 2 or more\n          this._state = this.STATE.TOUCH_ZOOM_PAN;\n          const dx = event.touches[0].pageX - event.touches[1].pageX;\n          const dy = event.touches[0].pageY - event.touches[1].pageY;\n          this._touchZoomDistanceEnd = this._touchZoomDistanceStart = Math.sqrt(dx * dx + dy * dy);\n          const x = (event.touches[0].pageX + event.touches[1].pageX) / 2;\n          const y = (event.touches[0].pageY + event.touches[1].pageY) / 2;\n\n          this._panStart.copy(this.getMouseOnScreen(x, y));\n\n          this._panEnd.copy(this._panStart);\n\n          break;\n      }\n\n      this.dispatchEvent(this.startEvent);\n    });\n\n    _defineProperty(this, \"touchmove\", event => {\n      if (this.enabled === false) return;\n      event.preventDefault();\n\n      switch (event.touches.length) {\n        case 1:\n          this._movePrev.copy(this._moveCurr);\n\n          this._moveCurr.copy(this.getMouseOnCircle(event.touches[0].pageX, event.touches[0].pageY));\n\n          break;\n\n        default:\n          // 2 or more\n          const dx = event.touches[0].pageX - event.touches[1].pageX;\n          const dy = event.touches[0].pageY - event.touches[1].pageY;\n          this._touchZoomDistanceEnd = Math.sqrt(dx * dx + dy * dy);\n          const x = (event.touches[0].pageX + event.touches[1].pageX) / 2;\n          const y = (event.touches[0].pageY + event.touches[1].pageY) / 2;\n\n          this._panEnd.copy(this.getMouseOnScreen(x, y));\n\n          break;\n      }\n    });\n\n    _defineProperty(this, \"touchend\", event => {\n      if (this.enabled === false) return;\n\n      switch (event.touches.length) {\n        case 0:\n          this._state = this.STATE.NONE;\n          break;\n\n        case 1:\n          this._state = this.STATE.TOUCH_ROTATE;\n\n          this._moveCurr.copy(this.getMouseOnCircle(event.touches[0].pageX, event.touches[0].pageY));\n\n          this._movePrev.copy(this._moveCurr);\n\n          break;\n      }\n\n      this.dispatchEvent(this.endEvent);\n    });\n\n    _defineProperty(this, \"contextmenu\", event => {\n      if (this.enabled === false) return;\n      event.preventDefault();\n    });\n\n    _defineProperty(this, \"dispose\", () => {\n      this.domElement.removeEventListener('contextmenu', this.contextmenu);\n      this.domElement.removeEventListener('pointerdown', this.onPointerDown);\n      this.domElement.removeEventListener('wheel', this.mousewheel);\n      this.domElement.removeEventListener('touchstart', this.touchstart);\n      this.domElement.removeEventListener('touchend', this.touchend);\n      this.domElement.removeEventListener('touchmove', this.touchmove);\n      this.domElement.ownerDocument.removeEventListener('pointermove', this.onPointerMove);\n      this.domElement.ownerDocument.removeEventListener('pointerup', this.onPointerUp);\n      window.removeEventListener('keydown', this.keydown);\n      window.removeEventListener('keyup', this.keyup);\n    });\n\n    if (domElement === undefined) {\n      console.warn('THREE.TrackballControls: The second parameter \"domElement\" is now mandatory.');\n    }\n\n    this.object = object;\n    this.domElement = domElement; // for reset\n\n    this.target0 = this.target.clone();\n    this.position0 = this.object.position.clone();\n    this.up0 = this.object.up.clone();\n    this.zoom0 = this.object.zoom; // listeners\n\n    this.domElement.addEventListener('contextmenu', this.contextmenu);\n    this.domElement.addEventListener('pointerdown', this.onPointerDown);\n    this.domElement.addEventListener('wheel', this.mousewheel);\n    this.domElement.addEventListener('touchstart', this.touchstart);\n    this.domElement.addEventListener('touchend', this.touchend);\n    this.domElement.addEventListener('touchmove', this.touchmove);\n    this.domElement.ownerDocument.addEventListener('pointermove', this.onPointerMove);\n    this.domElement.ownerDocument.addEventListener('pointerup', this.onPointerUp);\n    window.addEventListener('keydown', this.keydown);\n    window.addEventListener('keyup', this.keyup);\n    this.handleResize(); // force an update at start\n\n    this.update();\n  }\n\n}\n\nexport { TrackballControls };\n"]},"metadata":{},"sourceType":"module"}