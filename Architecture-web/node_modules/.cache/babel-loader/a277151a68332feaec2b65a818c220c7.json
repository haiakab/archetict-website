{"ast":null,"code":"import _objectWithoutPropertiesLoose from '@babel/runtime/helpers/esm/objectWithoutPropertiesLoose';\nimport { useRef, useState, useLayoutEffect, createElement } from 'react';\nimport { Box3, Vector3, Sphere } from 'three';\nimport { useThree } from '@react-three/fiber';\nimport { Environment } from './Environment.js';\nimport { ContactShadows } from './ContactShadows.js';\n\nfunction Stage(_ref) {\n  let {\n    children,\n    controls,\n    contactShadow,\n    shadows,\n    adjustCamera,\n    environment,\n    intensity = 1\n  } = _ref,\n      props = _objectWithoutPropertiesLoose(_ref, [\"children\", \"controls\", \"contactShadow\", \"shadows\", \"adjustCamera\", \"environment\", \"intensity\"]);\n\n  const camera = useThree(state => state.camera);\n  const outer = useRef(null);\n  const inner = useRef(null);\n  const [{\n    radius,\n    width,\n    height\n  }, set] = useState({\n    radius: 0,\n    width: 0,\n    height: 0\n  });\n  useLayoutEffect(() => {\n    outer.current.position.set(0, 0, 0);\n    outer.current.updateWorldMatrix(true, true);\n    const box3 = new Box3().setFromObject(inner.current);\n    const center = new Vector3();\n    const sphere = new Sphere();\n    const height = box3.max.y - box3.min.y;\n    const width = box3.max.x - box3.min.x;\n    box3.getCenter(center);\n    box3.getBoundingSphere(sphere);\n    set({\n      radius: sphere.radius,\n      width,\n      height\n    });\n    outer.current.position.set(-center.x, -center.y + height / 2, -center.z);\n  }, [children]);\n  useLayoutEffect(() => {\n    if (adjustCamera) {\n      const y = radius / (height > width ? 1.5 : 2.5);\n      camera.position.set(0, radius * 1.5, radius * 2.5);\n      camera.near = 0.1;\n      camera.far = Math.max(5000, radius * 4);\n      camera.lookAt(0, y, 0);\n\n      if (controls && controls.current) {\n        controls.current.target.set(0, y, 0);\n        controls.current.update();\n      }\n    }\n  }, [radius, height, width, adjustCamera]);\n  return /*#__PURE__*/createElement(\"group\", props, /*#__PURE__*/createElement(\"group\", {\n    ref: outer\n  }, /*#__PURE__*/createElement(\"group\", {\n    ref: inner\n  }, children)), contactShadow && /*#__PURE__*/createElement(ContactShadows, {\n    \"rotation-x\": Math.PI / 2,\n    opacity: 0.5,\n    width: radius * 2,\n    height: radius * 2,\n    blur: 2,\n    far: radius / 2\n  }), /*#__PURE__*/createElement(\"spotLight\", {\n    position: [radius, radius * 2, radius],\n    intensity: intensity * 2,\n    castShadow: shadows\n  }), /*#__PURE__*/createElement(\"pointLight\", {\n    position: [-radius * 2, -radius * 2, -radius * 2],\n    intensity: intensity\n  }), environment && /*#__PURE__*/createElement(Environment, {\n    preset: environment\n  }));\n}\n\nexport { Stage };","map":{"version":3,"sources":["/Users/haiakablan/Documents/לוטוס/קורס/Architecture-web/node_modules/@react-three/drei/core/Stage.js"],"names":["_objectWithoutPropertiesLoose","useRef","useState","useLayoutEffect","createElement","Box3","Vector3","Sphere","useThree","Environment","ContactShadows","Stage","_ref","children","controls","contactShadow","shadows","adjustCamera","environment","intensity","props","camera","state","outer","inner","radius","width","height","set","current","position","updateWorldMatrix","box3","setFromObject","center","sphere","max","y","min","x","getCenter","getBoundingSphere","z","near","far","Math","lookAt","target","update","ref","PI","opacity","blur","castShadow","preset"],"mappings":"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","sourcesContent":["import _objectWithoutPropertiesLoose from '@babel/runtime/helpers/esm/objectWithoutPropertiesLoose';\nimport { useRef, useState, useLayoutEffect, createElement } from 'react';\nimport { Box3, Vector3, Sphere } from 'three';\nimport { useThree } from '@react-three/fiber';\nimport { Environment } from './Environment.js';\nimport { ContactShadows } from './ContactShadows.js';\n\nfunction Stage(_ref) {\n  let {\n    children,\n    controls,\n    contactShadow,\n    shadows,\n    adjustCamera,\n    environment,\n    intensity = 1\n  } = _ref,\n      props = _objectWithoutPropertiesLoose(_ref, [\"children\", \"controls\", \"contactShadow\", \"shadows\", \"adjustCamera\", \"environment\", \"intensity\"]);\n\n  const camera = useThree(state => state.camera);\n  const outer = useRef(null);\n  const inner = useRef(null);\n  const [{\n    radius,\n    width,\n    height\n  }, set] = useState({\n    radius: 0,\n    width: 0,\n    height: 0\n  });\n  useLayoutEffect(() => {\n    outer.current.position.set(0, 0, 0);\n    outer.current.updateWorldMatrix(true, true);\n    const box3 = new Box3().setFromObject(inner.current);\n    const center = new Vector3();\n    const sphere = new Sphere();\n    const height = box3.max.y - box3.min.y;\n    const width = box3.max.x - box3.min.x;\n    box3.getCenter(center);\n    box3.getBoundingSphere(sphere);\n    set({\n      radius: sphere.radius,\n      width,\n      height\n    });\n    outer.current.position.set(-center.x, -center.y + height / 2, -center.z);\n  }, [children]);\n  useLayoutEffect(() => {\n    if (adjustCamera) {\n      const y = radius / (height > width ? 1.5 : 2.5);\n      camera.position.set(0, radius * 1.5, radius * 2.5);\n      camera.near = 0.1;\n      camera.far = Math.max(5000, radius * 4);\n      camera.lookAt(0, y, 0);\n\n      if (controls && controls.current) {\n        controls.current.target.set(0, y, 0);\n        controls.current.update();\n      }\n    }\n  }, [radius, height, width, adjustCamera]);\n  return /*#__PURE__*/createElement(\"group\", props, /*#__PURE__*/createElement(\"group\", {\n    ref: outer\n  }, /*#__PURE__*/createElement(\"group\", {\n    ref: inner\n  }, children)), contactShadow && /*#__PURE__*/createElement(ContactShadows, {\n    \"rotation-x\": Math.PI / 2,\n    opacity: 0.5,\n    width: radius * 2,\n    height: radius * 2,\n    blur: 2,\n    far: radius / 2\n  }), /*#__PURE__*/createElement(\"spotLight\", {\n    position: [radius, radius * 2, radius],\n    intensity: intensity * 2,\n    castShadow: shadows\n  }), /*#__PURE__*/createElement(\"pointLight\", {\n    position: [-radius * 2, -radius * 2, -radius * 2],\n    intensity: intensity\n  }), environment && /*#__PURE__*/createElement(Environment, {\n    preset: environment\n  }));\n}\n\nexport { Stage };\n"]},"metadata":{},"sourceType":"module"}