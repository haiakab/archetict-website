"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),r=require("@react-three/fiber"),n=require("three-stdlib"),t=require("three"),u=require("use-asset"),o=require("../helpers/environment-assets.cjs.js");exports.Environment=function(s){var i=s.background,a=void 0!==i&&i,c=s.files,d=void 0===c?["px.png","nx.png","py.png","ny.png","pz.png","nz.png"]:c,p=s.path,b=void 0===p?"/":p,f=s.preset,v=void 0===f?void 0:f,g=s.scene;if(v){if(!(v in o.presetsObj))throw new Error("Preset must be one of: "+Object.keys(o.presetsObj).join(", "));d=o.presetsObj[v],b="https://rawcdn.githack.com/pmndrs/drei-assets/aa3600359ba664d546d05821bcbca42013587df2/hdri/"}var m=r.useThree((function(e){return e.scene})),h=r.useThree((function(e){return e.gl})),l=Array.isArray(d),k=l?t.CubeTextureLoader:n.RGBELoader,j=r.useLoader(k,l?[d]:d,(function(e){return e.setPath(b)})),q=l?j[0]:j,x=u.useAsset((function(){return new Promise((function(e){var r=new t.PMREMGenerator(h),n=function(e,r,n){return n?(r.compileEquirectangularShader(),r.fromCubemap(e).texture):r.fromEquirectangular(e).texture}(q,r,l);r.dispose(),e(n)}))}),q);return e.useLayoutEffect((function(){var e=g?g.background:m.background,r=g?g.environment:m.environment;return g?(g.environment=x,a&&(g.background=x)):(m.environment=x,a&&(m.background=x)),function(){g?(g.environment=r,g.background=e):(m.environment=r,m.background=e),u.useAsset.clear(q),x.dispose()}}),[x,a,g]),null};
