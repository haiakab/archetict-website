"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),t=require("@react-three/fiber");require("@babel/runtime/helpers/extends");var r=require("@babel/runtime/helpers/objectWithoutPropertiesLoose");require("three-stdlib");var n=require("three"),i=require("./ContactShadows.cjs.js");require("use-asset"),require("../helpers/environment-assets.cjs.js");var a=require("./Environment.cjs.js");function o(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var s=o(r);exports.Stage=function(r){var o=r.children,u=r.controls,c=r.contactShadow,h=r.shadows,d=r.adjustCamera,l=r.environment,p=r.intensity,m=void 0===p?1:p,f=s.default(r,["children","controls","contactShadow","shadows","adjustCamera","environment","intensity"]),v=t.useThree((function(e){return e.camera})),g=e.useRef(null),w=e.useRef(null),j=e.useState({radius:0,width:0,height:0}),x=j[0],y=x.radius,b=x.width,E=x.height,q=j[1];return e.useLayoutEffect((function(){g.current.position.set(0,0,0),g.current.updateWorldMatrix(!0,!0);var e=(new n.Box3).setFromObject(w.current),t=new n.Vector3,r=new n.Sphere,i=e.max.y-e.min.y,a=e.max.x-e.min.x;e.getCenter(t),e.getBoundingSphere(r),q({radius:r.radius,width:a,height:i}),g.current.position.set(-t.x,-t.y+i/2,-t.z)}),[o]),e.useLayoutEffect((function(){if(d){var e=y/(E>b?1.5:2.5);v.position.set(0,1.5*y,2.5*y),v.near=.1,v.far=Math.max(5e3,4*y),v.lookAt(0,e,0),u&&u.current&&(u.current.target.set(0,e,0),u.current.update())}}),[y,E,b,d]),e.createElement("group",f,e.createElement("group",{ref:g},e.createElement("group",{ref:w},o)),c&&e.createElement(i.ContactShadows,{"rotation-x":Math.PI/2,opacity:.5,width:2*y,height:2*y,blur:2,far:y/2}),e.createElement("spotLight",{position:[y,2*y,y],intensity:2*m,castShadow:h}),e.createElement("pointLight",{position:[2*-y,2*-y,2*-y],intensity:m}),l&&e.createElement(a.Environment,{preset:l}))};
